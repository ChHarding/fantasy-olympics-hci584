<html>
    <head>
        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <link rel="stylesheet" href="../static/css/draft.css" />
        <link 
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@6.6.6/css/flag-icons.min.css"
        />
    </head>
    <body>
        <h1 class="title"> DRAFT </h1>
        <div class="mainContainer">
            <div>
                Round {{ player }}
            </div>
            <div>
                Pick your team, {{ player }}
            </div>
            <div>{{ error }}</div>
            <form class="form" action="/draft" id="league_selection" method="POST" />
        </div>
    </body>

    <script type="text/javascript">
        let countries = '{{ available_countries }}'.replace(/&#39;/g, '').replace('[', '').replace(']', '').split(", ");
        counts = {};
        countries.forEach(function(country) { counts[country] = (counts[country] || 0) + 1; });
        console.log(counts);
        countries = Array.from(new Set(countries));
        console.log(countries);
        for (country of countries) {
            const countryButton = document.createElement('button');
            countryButton.setAttribute('type', 'submit');
            countryButton.setAttribute('name', country);
            countryButton.setAttribute('value', country);
            countryButton.setAttribute('class', 'countryButton');
            const img = document.createElement('span');
            img.setAttribute('class', 'flag fi-us');
            countryButton.appendChild(img);
            const text = document.createElement('div');
            const countryName = document.createElement('div');
            countryName.appendChild(document.createTextNode(country));
            const availability = document.createElement('div');
            availability.appendChild(document.createTextNode('Available ' + counts[country] + ' times'));
            text.appendChild(countryName);
            text.appendChild(availability);
            countryButton.appendChild(text);
            document.getElementById("league_selection").appendChild(countryButton);
        }
    </script>
</html>